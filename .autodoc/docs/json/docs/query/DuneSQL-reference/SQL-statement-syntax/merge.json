{
  "fileName": "merge.md",
  "filePath": "docs/query/DuneSQL-reference/SQL-statement-syntax/merge.md",
  "url": "https://dune.com/docs/query/DuneSQL-reference/SQL-statement-syntax/merge.md",
  "summary": "# MERGE\n\nThe `MERGE` statement is used to conditionally update and/or delete rows of a table and/or insert new rows into a table. This section of the app technical guide provides a detailed explanation of the `MERGE` statement, including its syntax, description, examples, and limitations.\n\nThe `MERGE` statement has the following syntax:\n\n``` text\nMERGE INTO target_table [ [ AS ]  target_alias ]\nUSING { source_table | query } [ [ AS ] source_alias ]\nON search_condition\nwhen_clause [...]\n```\n\nwhere `when_clause` is one of:\n\n``` text\nWHEN MATCHED [ AND condition ]\n    THEN DELETE\n```\n\n``` text\nWHEN MATCHED [ AND condition ]\n    THEN UPDATE SET ( column = expression [, ...] )\n```\n\n``` text\nWHEN NOT MATCHED [ AND condition ]\n    THEN INSERT [ column_list ] VALUES (expression, ...)\n```\n\nThe `MERGE` statement supports an arbitrary number of `WHEN` clauses with different `MATCHED` conditions, executing the `DELETE`, `UPDATE`, or `INSERT` operation in the first `WHEN` clause selected by the `MATCHED` state and the match condition.\n\nFor each source row, the `WHEN` clauses are processed in order. Only the first matching `WHEN` clause is executed, and subsequent clauses are ignored. A `MERGE_TARGET_ROW_MULTIPLE_MATCHES` exception is raised when a single target table row matches more than one source row.\n\nIf a source row is not matched by any `WHEN` clause and there is no `WHEN NOT MATCHED` clause, the source row is ignored.\n\nIn `WHEN` clauses with `UPDATE` operations, the column value expressions can depend on any field of the target or the source. In the `NOT MATCHED` case, the `INSERT` expressions can depend on any field of the source.\n\nThe examples provided in this section illustrate how to use the `MERGE` statement to delete customers, update purchases, and insert new rows into a table. The examples show how to use the `MERGE` statement with different `WHEN` clauses and match conditions.\n\nThe `MERGE` statement has some limitations. Any connector can be used as a source table for a `MERGE` statement. However, only connectors that support the `MERGE` statement can be the target of a merge operation. Refer to the connector documentation for more information.\n\nIn summary, the `MERGE` statement is a powerful SQL statement that allows you to conditionally update and/or delete rows of a table and/or insert new rows into a table. The `MERGE` statement supports an arbitrary number of `WHEN` clauses with different `MATCHED` conditions, executing the `DELETE`, `UPDATE`, or `INSERT` operation in the first `WHEN` clause selected by the `MATCHED` state and the match condition. The examples provided in this section illustrate how to use the `MERGE` statement with different `WHEN` clauses and match conditions.",
  "questions": "1. What is the purpose of the `MERGE` statement in the context of a blockchain SQL database?\n- Answer: A blockchain SQL analyst might want to know how the `MERGE` statement can be used to conditionally update, delete, and insert rows in a table, and whether it can be used to modify blockchain data.\n\n2. Are there any limitations to using the `MERGE` statement with blockchain data?\n- Answer: A blockchain SQL analyst might want to know if there are any limitations to using the `MERGE` statement with blockchain data, and whether any specific connectors are required.\n\n3. Can the `MERGE` statement be used to modify data in a blockchain network?\n- Answer: A blockchain SQL analyst might want to know if the `MERGE` statement can be used to modify data in a blockchain network, and if so, what implications this might have for the integrity and security of the network."
}